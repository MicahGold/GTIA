<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BATNA & ZOPA Analysis</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding-top: 70px;
            background-color: #f9f9f9;
            color: #333;
        }

        nav {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 40px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            z-index: 1000;
        }

        nav ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: flex;
            gap: 25px;
        }

        nav li {
            display: inline;
        }

        nav a {
            text-decoration: none;
            color: #333;
            font-size: 16px;
            font-weight: 500;
            padding: 10px 15px;
            border-radius: 6px;
            transition: all 0.25s ease;
        }

        nav a:hover {
            background-color: #e0e0e0;
            color: #000;
        }

        nav a.active {
            background-color: #0066cc;
            color: white;
        }

        .section {
            max-width: 1100px;
            margin: 40px auto;
            padding: 20px 40px;
            background-color: #fff;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .section h2 {
            font-size: 28px;
            margin-bottom: 20px;
            border-bottom: 2px solid #ccc;
            padding-bottom: 8px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 10px;
        }

        th, td {
            padding: 14px 18px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
            vertical-align: top;
        }

        th {
            background-color: #f5f5f5;
            font-weight: 600;
            font-size: 15px;
        }

        tr:hover {
            background-color: #fafafa;
        }

        td ul {
            margin: 6px 0 0 18px;
            padding-left: 0;
        }

        td ul li {
            margin-bottom: 4px;
            line-height: 1.5;
        }

        .positive {
            color: green;
            font-weight: 500;
        }

        .negative {
            color: red;
            font-weight: 500;
        }
        
        .new-data {
            background-color: #fffde7;
        }

        .updated {
            background-color: #e8f5e9;
        }
    </style>
</head>
<body>

    <nav>
        <ul>
            <li><a href="index.html">Case Introduction</a></li>
            <li><a href="dramatis-personae.html">Dramatis Personae</a></li>
            <li><a href="facts.html">Facts</a></li>
            <li><a href="rules.html">Negotiation Rules</a></li>
            <li><a href="misc-analysis.html">Misc Analysis</a></li>
            <li><a href="nash.html" class="active">BATNA & ZOPA</a></li>
            <li><a href="strategy.html">Negotiation Strategy</a></li>
            <li><a href="submit.html">Submit Deal</a></li>
        </ul>
    </nav>

    <div class="section">
        <h2>Game Theory Decision Matrix</h2>
        <table>
            <tr>
                <th>Party</th>
                <th>Best Option</th>
                <th>Second Best</th>
                <th>Third Best</th>
                <th>Worst Option</th>
            </tr>
            <tr class="updated">
                <td>Geoff</td>
                <td class="negative">Settlement with Return (EV = −3x)</td>
                <td class="negative">Settlement without Return (EV = −x − 4,700)</td>
                <td class="negative">Litigation (EV = −7,510.13)</td>
                <td class="negative">Pay in Full (EV = −8,205)</td>
            </tr>
            <tr class="updated">
                <td>Steph</td>
                <td class="negative">Settlement with Return (EV = −3x)</td>
                <td class="negative">Settlement without Return (EV = −x − 4,700)</td>
                <td class="negative">Pay in Full (EV = −8,205)</td>
                <td class="negative">Litigation (EV = −10,210.13)</td>
            </tr>
            <tr class="updated">
                <td>Intellicorp</td>
                <td class="positive">Settlement with Return (EV = 21,948 + 3x)</td>
                <td class="positive">Pay in Full (EV = 10,621)</td>
                <td class="positive">Litigation (EV = 10,196.39)</td>
                <td class="positive">Settlement without Return (EV = 7,316 + x)</td>
            </tr>
            <tr class="updated">
                <td>Heath Crair</td>
                <td class="positive">Settlement with Return (474 + 1.5x)</td>
                <td class="positive">Pay in Full (1,448.40)</td>
                <td class="positive">Settlement without Return (158 + 0.5x)</td>
                <td class="positive">Litigation EV (151.20)</td>
            </tr>
            <tr class="updated">
                <td>Aesculapius</td>
                <td class="positive">Settlement with Return (474 + 1.5x)</td>
                <td class="positive">Pay in Full (2,172.60)</td>
                <td class="positive">Settlement without Return (158 + 0.5x)</td>
                <td class="positive">Litigation EV (151.20)</td>
            </tr>
        </table>
    </div>

    <div class="section">
        <h2>BATNA & ZOPA Analysis</h2>
        <table>
            <tr>
                <th>Party</th>
                <th>BATNA (Best Alternative to a Negotiated Agreement)</th>
                <th>RP (Reserve Price)</th>
                <th>Notes</th>
            </tr>
            <tr class="updated">
                <td>Geoff</td>
                <td class="negative">Litigation (EV: –$7,510.13)</td>
                <td>$x &lt; 2,503.38</td>
                <td>
                    Prefers:
                    <ul>
                        <li><strong>Settlement with Return</strong> if <em>x &lt; 2,503.38</em></li>
                        <li><strong>Settlement without Return</strong> if <em>2,503.38 &lt;x &lt; 2,810.13</em></li>
                        <li><strong>Litigation otherwise
                        <li><strong>Pay in Full</strong> is worst option (EV: –$8,205.00)</li>
                    </ul>
                </td>
            </tr>
            <tr class="updated">
                <td>Steph</td>
                <td class="negative">Litigation (EV: –$10,210.13)</td>
                <td>$x &lt; 2,735.00</td>
                <td>
                    Prefers:
                    <ul>
                        <li><strong>Settlement with Return</strong> if <em>x &lt; 2,735.00</em></li>
                        <li><strong>Settlement without Return</strong> if <em> 2,735.00 &lt; x &lt; 3,505.00</em></li>
                        <li><strong>Pay in Full</strong> otherwise (but Geoff must okay)
                        <li><strong>Litigation</strong> is worst option (EV: –$10,210.13)</li>
                    </ul>
                </td>
            </tr>
            <tr class="updated">
                <td>Heath Crair</td>
                <td class="positive">Litigation (EV: $151.20)</td>
                <td>$x &gt; 0</td>
                <td>
                    Prefers:
                    <ul>
                        <li><strong>Settlement with Return</strong> if <em>x &gt; 649.60</em></li>
                        <li><strong>Pay in Full</strong> if <em>x &lt; 649.60</em></li>
                        <li><strong>Settlement without Return</strong> for any price to avoid litigation
                        <li><strong>Litigation</strong> is worst option (EV: $151.20)</li>
                    </ul>
        
                </td>
            </tr>
            <tr class="updated">
                <td>Aesculapius</td>
                <td class="positive">Litigation (EV: $151.20)</td>
                <td>$x &gt; 0</td>
                <td>
                    Prefers:
                    <ul>
                        <li><strong>Settlement with Return</strong> if <em>x &gt; 1,132.40</em></li>
                        <li><strong>Pay in Full</strong> if <em>x &lt; 1,132.40</em></li>
                        <li><strong>Settlement without Return</strong> for any price to avoid litigation
                        <li><strong>Litigation</strong> is worst option (EV: $151.20)</li>
                    </ul>
        
                </td>
            </tr>
        </table>
    </div>
    

    <div class="section">
        <h2>ZOPA Visualization</h2>
        <canvas id="zopaChart" width="900" height="400"></canvas>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const ctx = document.getElementById('zopaChart').getContext('2d');
    
        // Create gradient
        const gradient = ctx.createLinearGradient(0, 0, 0, 400);
        gradient.addColorStop(0, 'rgba(0, 200, 0, 0.3)');
        gradient.addColorStop(1, 'rgba(0, 200, 0, 0.05)');
        
        // Draw the chart manually
        function drawChart() {
    ctx.clearRect(0, 0, 900, 400);
    
    // Set up the scale
    const xStart = -1000;
    const xEnd = 3000;
    const yStart = 350;
    const yHeight = 50;
    const xScale = 900 / xEnd;
    
    // Draw X axis
    ctx.beginPath();
    ctx.moveTo(0, yStart);
    ctx.lineTo(900, yStart);
    ctx.strokeStyle = '#666';
    ctx.stroke();
    
    // Draw X axis labels
    ctx.font = "12px Arial";
    ctx.fillStyle = "#333";
    ctx.textAlign = "center";
    for(let i = -1000; i <= xEnd; i += 500) {
        const x = i * xScale;
        ctx.fillText(i.toString(), x, yStart + 20);
        
        // Tick marks
        ctx.beginPath();
        ctx.moveTo(x, yStart);
        ctx.lineTo(x, yStart + 5);
        ctx.stroke();
    }
    
    // Draw X axis title
    ctx.font = "14px Arial";
    ctx.fillText("Settlement Offer ($)", 400, yStart + 40);
    
    // Draw title
    ctx.font = "20px Arial";
    ctx.fillStyle = "#000";
    ctx.fillText("Zone of Possible Agreement (ZOPA)", 300, 30);
    
    // Define thresholds
    const thresholds = [
        { value: 2503.38, label: "Geoff ≤ 2503.38", color: 'red',    position: 'top'    },
        { value: 2735,    label: "Steph ≤ 2735",    color: 'orange', position: 'top'    },
        { value: 0,       label: "Heath ≥ 0",      color: 'purple', position: 'top' },
        { value: 0,       label: "Aesculapius ≥ 0",color: 'teal',   position: 'bottom' },
    ];
    
    thresholds.forEach(th => {
        const xRaw = th.value * xScale;
        
        // draw the vertical line
        ctx.beginPath();
        ctx.moveTo(xRaw, 100);
        ctx.lineTo(xRaw, yStart);
        ctx.strokeStyle = th.color;
        ctx.lineWidth = 2;
        ctx.stroke();
        ctx.lineWidth = 1;
        
        // measure label
        ctx.font = "12px Arial";
        const textWidth = ctx.measureText(th.label).width;
        
        // decide alignment & clamp to edges
        let labelX = xRaw, align = 'center';
        if (xRaw <= textWidth/2 + 5) {
            labelX = 5;           // pad from left
            align = 'left';
        } else if (xRaw >= 900 - (textWidth/2 + 5)) {
            labelX = 900 - 5;     // pad from right
            align = 'right';
        }
        
        // determine vertical placement
        const labelY = th.position === 'top' ? 100 - 10 : yStart + 20;
        
        // draw background box
        let rectX;
        if (align === 'center') {
            rectX = labelX - (textWidth/2) - 5;
        } else if (align === 'left') {
            rectX = labelX - 5;
        } else { // right
            rectX = labelX - textWidth - 5;
        }
        ctx.fillStyle = th.color;
        ctx.fillRect(rectX, labelY - 12, textWidth + 10, 16);
        
        // draw text
        ctx.fillStyle = "#fff";
        ctx.textAlign = align;
        ctx.fillText(th.label, labelX, labelY);
        
        // reset for next
        ctx.textAlign = "center";
    });
    
    // Draw ZOPA region
    const zopaStart = 0 * xScale;
    const zopaEnd   = 2503.38 * xScale;
    const gradient  = ctx.createLinearGradient(0, 0, 0, 400);
    gradient.addColorStop(0, 'rgba(0,200,0,0.3)');
    gradient.addColorStop(1, 'rgba(0,200,0,0.05)');
    
    // fill & outline
    ctx.fillStyle = gradient;
    ctx.fillRect(zopaStart, 100, zopaEnd - zopaStart, yStart - 100);
    ctx.beginPath();
    ctx.rect(zopaStart, 100, zopaEnd - zopaStart, yStart - 100);
    ctx.strokeStyle = 'rgba(0,200,0,1)';
    ctx.lineWidth = 3;
    ctx.stroke();
    ctx.lineWidth = 1;
    
    // ZOPA label
    ctx.font = "16px Arial";
    ctx.fillStyle = "rgba(0,100,0,0.8)";
    ctx.textAlign = "center";
    ctx.fillText("ZOPA", (zopaStart + zopaEnd)/2, 200);
    ctx.textAlign = "left";
}
        
        // Call the function to draw the chart
        drawChart();
    </script>
    
    <div class="section">
        <h2>ZOPA Analysis Summary</h2>
        <p>Based on the above analysis, the Zone of Possible Agreement (ZOPA) exists in the range of <strong>0 to $2,503.38</strong>. This represents the range where:</p>
        <ul>
            <li>Geoff prefers settlement with return over litigation (x &lt; $2,503.38)</li>
            <li>Steph prefers settlement with return over paying in full (x &lt; $2,735)</li>
            <li>Heath Crair prefers settlement over litigation (x &gt; 0)</li>
            <li>Aesculapius prefers settlement over litigation (x &gt; 0)</li>
        </ul>
        <p>The upper bound of the ZOPA is determined by Geoff's reservation price ($2,503.38), while the lower bound is determined by Aesculapius's reservation price ($151.20).</p>
        <p>This indicates that a settlement with return of the product where the payment amount x is between $151.20 and $2,503.38 would be acceptable to all parties.</p>

        <p>Notably this negotiation is rather complex because each party has differing incentives. For example, Steph prefers full payment to litigation while Geoff does not and Aesculapius prefers full payment to larger settlements than Heath because of the possibility of his bonus. To reflect the multiple negotiatons captured within this single negotiation Steph's RP is given rather informally with respect to paying the full amount while her BATNA is given with respect to her "negotiation" with Geoff over whether to litigate.</p>
    </div>
</body>
</html>